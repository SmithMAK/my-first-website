<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Camping Swag | Cart</title>

  <!-- ─── GOOGLE FONTS ────────────────────────────────────────────────────────── -->
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Libre+Caslon+Text:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- ─── FONT AWESOME 6.x FREE ────────────────────────────────────────────────── -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha384-XxX..."
    crossorigin="anonymous"
  />

  <!-- ─── MAIN CSS ─────────────────────────────────────────────────────────────── -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <!--                           STICKY NAVIGATION BAR                            -->
  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <header class="site-header">
    <div class="header-inner container">
      <!-- Logo on the left -->
      <a href="index.html" class="logo-link">
        <img
          src="assets/logo.jpg"
          alt="Camping Swag Logo"
          class="logo-img"
        />
      </a>

      <!-- Primary navigation menu -->
      <nav class="primary-nav">
        <ul>
          <li><a href="index.html" class="nav-link">Home</a></li>
          <li class="has-submenu">
            <a href="search.html" class="nav-link">
              Shop Now <i class="fas fa-chevron-down"></i>
            </a>
            <ul class="submenu">
              <li><a href="search.html#tents" class="submenu-link">Tents</a></li>
              <li><a href="search.html#swags" class="submenu-link">Swags</a></li>
              <li><a href="search.html#packs" class="submenu-link">Packs</a></li>
            </ul>
          </li>
          <li><a href="about.html" class="nav-link">About</a></li>
          <li><a href="blog.html" class="nav-link">Blog</a></li>
        </ul>
      </nav>

      <!-- Icons on the right: search and cart -->
      <div class="nav-icons">
        <a href="search.html" aria-label="Search" class="nav-icon-link">
          <i class="fas fa-search"></i>
        </a>
        <a href="cart.html" aria-label="Cart" class="nav-icon-link">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-count">0</span>
        </a>
      </div>
    </div>
  </header>

  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <!--                                YOUR CART                                     -->
  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <main class="container" style="margin: 2rem auto; max-width: 1000px;">
    <button onclick="window.location.href='search.html'" style="
      background-color: var(--color-accent);
      color: var(--color-text);
      border: none;
      padding: 0.75rem 1.5rem;
      font-family: var(--font-body);
      font-weight: 500;
      margin-bottom: 2rem;
      border-radius: 4px;
      cursor: pointer;
    ">
      ← Continue Shopping
    </button>

    <h2 style="font-family: var(--font-heading); font-size: 2rem; margin-bottom: 2rem; color: var(--color-text); text-align: center;">
      YOUR CART
    </h2>

    <!-- Empty Cart Placeholder -->
    <div id="empty-cart" style="
      display: none;
      background-color: var(--color-accent);
      border-radius: 8px;
      padding: 3rem;
      text-align: center;
      color: var(--color-text);
      font-family: var(--font-body);
      font-size: 1.1rem;
    ">
      <i class="fas fa-shopping-bag" style="font-size: 3rem; margin-bottom: 1rem;"></i><br />
      No items in your cart
    </div>

    <!-- Cart Items Table -->
    <div id="cart-items" style="display: none; margin-bottom: 2rem;">
      <!-- We'll generate line items here via JS -->
    </div>

    <!-- Total & Checkout -->
    <div id="cart-summary" style="display: none; text-align: right; margin-top: 2rem;">
      <p style="font-family: var(--font-body); font-size: 1.1rem; margin-bottom: 0.5rem;">Shipping Fee will be calculated at the time of purchase</p>
      <p style="font-family: var(--font-heading); font-size: 1.75rem; margin-bottom: 1rem; color: var(--color-text);">
        Total &nbsp; <strong id="grand-total">$0.00</strong>
      </p>
      <button onclick="window.location.href='checkout.html'" style="
        background-color: var(--color-text);
        color: #FFFFFF;
        border: none;
        padding: 0.85rem 2rem;
        font-family: var(--font-body);
        font-weight: 700;
        font-size: 1rem;
        border-radius: 4px;
        cursor: pointer;
      ">
        Checkout
      </button>
    </div>
  </main>

  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <!--                                  FOOTER                                     -->
  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <footer class="site-footer">
    <div class="footer-container container">
      <!-- Subscribe Column -->
      <div class="footer-col subscribe-col">
        <h3>Subscribe to get 10% OFF</h3>
        <p>Subscribe for store updates and discounts.</p>
        <form class="subscribe-form" action="#" method="POST">
          <input
            type="email"
            name="email"
            placeholder="Enter your Email"
            required
          />
          <button type="submit">Subscribe</button>
        </form>
        <p class="disclaimer">
          By subscribing you agree to the Term of Use &amp; Privacy Policy
        </p>
        <p class="copyright">&copy; 2025, CampingSwag</p>
      </div>

      <!-- About Column -->
      <div class="footer-col about-col">
        <h3>About</h3>
        <p>
          Proudly owned and run by Australians. Camping Swag Online is dedicated to offering high‐quality products at reasonable prices.
        </p>
        <a href="about.html" class="learn-more">LEARN MORE</a>
      </div>

      <!-- Shop Column -->
      <div class="footer-col shop-col">
        <h3>Shop</h3>
        <ul>
          <li><a href="search.html">Shop All</a></li>
          <li><a href="search.html#bestseller">Best Seller</a></li>
          <li><a href="search.html#newcoming">New Coming</a></li>
          <li><a href="search.html#onsale">On Sale</a></li>
        </ul>
      </div>

      <!-- Customer Care Column -->
      <div class="footer-col customer-col">
        <h3>Customer Care</h3>
        <ul>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="faqs.html">FAQs</a></li>
          <li><a href="terms.html">Terms & Conditions</a></li>
          <li><a href="shipping.html">Shipping & Returns</a></li>
        </ul>
        <!-- Social Media Icons -->
        <div class="footer-social">
          <a href="https://www.facebook.com" target="_blank" aria-label="Facebook"
            ><i class="fab fa-facebook-f"></i
          ></a>
          <a href="https://www.instagram.com" target="_blank" aria-label="Instagram"
            ><i class="fab fa-instagram"></i
          ></a>
          <a href="https://www.twitter.com" target="_blank" aria-label="Twitter"
            ><i class="fab fa-twitter"></i
          ></a>
          <a href="https://www.tiktok.com" target="_blank" aria-label="TikTok"
            ><i class="fab fa-tiktok"></i
          ></a>
          <a
            href="https://www.youtube.com"
            target="_blank"
            aria-label="YouTube"
            ><i class="fab fa-youtube"></i
          ></a>
        </div>
      </div>
    </div>
  </footer>

  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <!--                            MAIN JAVASCRIPT FILE                             -->
  <!-- ────────────────────────────────────────────────────────────────────────── -->
  <script src="main.js"></script>
  <script src="cart.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const cartContainer = document.getElementById('cart-items');
      const emptyCartDiv  = document.getElementById('empty-cart');
      const summaryDiv    = document.getElementById('cart-summary');
      const grandTotalEl  = document.getElementById('grand-total');

      // Build the table of line items
      function renderCart() {
        const cart = Cart.getCart();
        const keys = Object.keys(cart);

        // If no products, show the “empty cart” placeholder
        if (keys.length === 0) {
          emptyCartDiv.style.display   = 'block';
          cartContainer.style.display  = 'none';
          summaryDiv.style.display     = 'none';
          return;
        }

        emptyCartDiv.style.display  = 'none';
        cartContainer.style.display = 'block';
        summaryDiv.style.display    = 'block';

        // Clear any previous rows:
        cartContainer.innerHTML = '';

        // Create a <table> to hold the line items:
        const table = document.createElement('table');
        table.style.width = '100%';
        table.style.borderCollapse = 'collapse';
        table.style.marginBottom = '2rem';

        // Table Header Row (optional visually):
        const thead = document.createElement('thead');
        thead.innerHTML = `
          <tr style="border-bottom: 1px solid rgba(0,0,0,0.1); font-family: var(--font-body); font-weight: 500; color: var(--color-text);">
            <th style="text-align: left; padding: 0.5rem;">Product</th>
            <th style="text-align: center; padding: 0.5rem;">Unit Price</th>
            <th style="text-align: center; padding: 0.5rem;">Quantity</th>
            <th style="text-align: right; padding: 0.5rem;">Subtotal</th>
          </tr>
        `;
        table.appendChild(thead);

        // Table Body Rows
        const tbody = document.createElement('tbody');
        let grandTotal = 0;

        keys.forEach(pid => {
          const quantity = cart[pid];
          const product  = Cart.PRODUCTS[pid];
          const unitPrice = product.price;
          const lineTotal = (unitPrice * quantity);
          grandTotal += lineTotal;

          // Single row:
          const tr = document.createElement('tr');
          tr.style.borderBottom = '1px solid rgba(0,0,0,0.05)';

          // Product Image + Name
          const tdProduct = document.createElement('td');
          tdProduct.style.padding = '0.75rem';
          tdProduct.style.display = 'flex';
          tdProduct.style.alignItems = 'center';
          tdProduct.innerHTML = `
            <img
              src="${product.images[0]}"
              alt="${product.name}"
              style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-right: 1rem;"
            />
            <a href="${product.pageUrl}" style="font-family: var(--font-body); font-size: 1rem; color: var(--color-text); text-decoration: none;">
              ${product.name}
            </a>
          `;
          tr.appendChild(tdProduct);

          // Unit Price
          const tdPrice = document.createElement('td');
          tdPrice.style.textAlign = 'center';
          tdPrice.style.padding = '0.75rem';
          tdPrice.innerHTML = `<span style="font-family: var(--font-body); color: var(--color-text);">$${unitPrice.toFixed(2)}</span>`;
          tr.appendChild(tdPrice);

          // Quantity Controls (– ■ +)
          const tdQty = document.createElement('td');
          tdQty.style.textAlign = 'center';
          tdQty.style.padding = '0.75rem';
          tdQty.innerHTML = `
            <button class="qty-btn" data-action="decrease" data-id="${pid}" style="background-color: var(--color-accent); color: var(--color-text); border: none; padding: 0.4rem 0.8rem; font-size: 1rem; cursor: pointer; border-radius: 4px; margin-right: 0.5rem;">
              &minus;
            </button>
            <span id="line-qty-${pid}" style="font-family: var(--font-body); font-size: 1rem; min-width: 24px; display: inline-block; text-align: center;">${quantity}</span>
            <button class="qty-btn" data-action="increase" data-id="${pid}" style="background-color: var(--color-accent); color: var(--color-text); border: none; padding: 0.4rem 0.8rem; font-size: 1rem; cursor: pointer; border-radius: 4px; margin-left: 0.5rem;">
              &#43;
            </button>
          `;
          tr.appendChild(tdQty);

          // Subtotal
          const tdSubtotal = document.createElement('td');
          tdSubtotal.style.textAlign = 'right';
          tdSubtotal.style.padding = '0.75rem';
          tdSubtotal.id = `line-subtotal-${pid}`;
          tdSubtotal.innerHTML = `<span style="font-family: var(--font-body); color: var(--color-text);">$${lineTotal.toFixed(2)}</span>`;
          tr.appendChild(tdSubtotal);

          tbody.appendChild(tr);
        });

        table.appendChild(tbody);
        cartContainer.appendChild(table);

        // Finally, fill in grand total:
        grandTotalEl.textContent = `$${grandTotal.toFixed(2)}`;

        // Attach quantity‐button listeners
        document.querySelectorAll('.qty-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.dataset.id;
            const action    = this.dataset.action; // "increase" or "decrease"

            if (action === 'increase') {
              Cart.addToCart(productId);
            } else {
              Cart.removeFromCart(productId);
            }

            // Update this line’s row: new quantity and new subtotal
            const cartNow = Cart.getCart();
            const newQty  = cartNow[productId] || 0;
            document.getElementById(`line-qty-${productId}`).textContent = newQty;

            const product = Cart.PRODUCTS[productId];
            const newSub  = (product.price * newQty);
            document.getElementById(`line-subtotal-${productId}`).textContent = `$${newSub.toFixed(2)}`;

            // If quantity is now 0, remove this row entirely and re‐render if empty
            if (newQty === 0) {
              // Remove from table
              const row = this.closest('tr');
              row.parentNode.removeChild(row);

              // If no more items, show empty state
              if (Object.keys(cartNow).length === 0) {
                renderCart();
                return;
              }
            }

            // Recompute grand total
            let total = 0;
            Object.entries(cartNow).forEach(([pid, qty]) => {
              total += Cart.PRODUCTS[pid].price * qty;
            });
            grandTotalEl.textContent = `$${total.toFixed(2)}`;
          });
        });
      }

      // Initially call renderCart() to decide empty vs. line items:
      renderCart();
    });
  </script>
</body>
</html>
